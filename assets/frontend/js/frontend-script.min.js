function setMapMarkers(){var e,a;for(a=0;a<markers.length;a++){var t=new google.maps.LatLng(markers[a][1],markers[a][2]);bounds.extend(t),e=new google.maps.Marker({position:t,map:map}),google.maps.event.addListener(e,"click",function(e,a){return function(){infoWindow.setContent(infoWindowContent[a][0]),infoWindow.open(map,e)}}(e,a)),map_markers.push(e)}}function setMapOnAll(e){for(var a=0;a<map_markers.length;a++)map_markers[a].setMap(e)}function clearMarkers(){setMapOnAll(null)}function deleteMarkers(){clearMarkers(),map_markers=[]}function realEstateGeoFindMe(){function e(e){reverseGeoCode(e.coords.latitude,e.coords.longitude),$(searchForm).submit()}function a(){t.innerHTML="Unable to retrieve your location"}var t=document.getElementById("out");if(document.getElementById("search-address").value="Loading.. Please Wait..",!navigator.geolocation)return void(t.innerHTML="<p>Geolocation is not supported by your browser</p>");navigator.geolocation.getCurrentPosition(e,a)}function reverseGeoCode(e,a){jQuery("#lat").val(e),jQuery("#lng").val(a);var t=new google.maps.LatLng(e,a);geocoder.geocode({location:t},function(e,a){if("OK"===a)if(e[0]){var t=e[0].formatted_address;jQuery("#search-address").val(t)}else window.alert("No results found");else window.alert("Geocoder failed due to: "+a)})}function clearPagination(){$(loadMoreButton).data("paged",1),$(loadMoreButton).data("maxpages",1)}function initialize_empty_map(){if($("#map_canvas").length>0){myLat=xloc_default_latitude,myLng=xloc_default_longitude;var e={lat:myLat,lng:myLng},a={mapTypeId:"roadmap",zoom:xloc_default_zoom_level,center:e};void 0===map&&(map=new google.maps.Map(document.getElementById("map_canvas"),a)),google.maps.event.addDomListener(window,"resize",function(){var e=map.getCenter();google.maps.event.trigger(map,"resize"),map.setCenter(e)})}}function initialize(){bounds=new google.maps.LatLngBounds;var e={mapTypeId:"roadmap",zoom:xloc_default_zoom_level};void 0===map&&(map=new google.maps.Map(document.getElementById("map_canvas"),e)),deleteMarkers(),setMapMarkers(),markerCluster=new MarkerClusterer(map,map_markers,{imagePath:"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m"}),map.fitBounds(bounds),google.maps.event.addDomListener(window,"resize",function(){var e=map.getCenter();google.maps.event.trigger(map,"resize"),map.setCenter(e)})}function searchProperties(e,a){var t=$("#lat").val(),o=$("#lng").val();ajaxUrl=rem.ajax_url+"?action=get_xlocate_map",a?ajaxUrl=rem.ajax_url+"?action=get_xlocate_map&paged="+a:clearPagination(),""!==t&&""!==o&&$.ajax({type:"POST",url:ajaxUrl,data:e,beforeSend:function(){$("#xlocate-loader").show()},success:function(e){$("#xlocate-loader").hide(),e.mapData.markers instanceof Array&&(e.paginated||(markers=[]),e.mapData.markers.forEach(function(e){markers.push(e)})),e.mapData.infowindowcontent instanceof Array&&e.mapData.infowindowcontent.forEach(function(e){infoWindowContent.push(e)}),1==e.hide_map&&(deleteMarkers(),void 0!==markerCluster?markerCluster.clearMarkers():initialize_empty_map()),e.paginated?($("#xlocate-estate-listing").append(e.listing),deleteMarkers(),setMapMarkers(),markerCluster.clearMarkers(),markerCluster.addMarkers(map_markers),map.fitBounds(bounds),e.maxpages>1&&e.maxpages!==$(loadMoreButton).data("maxpages")&&($(loadMoreButton).data("maxpages",e.maxpages),$(loadMoreButton).show())):(e.mapData.markers?(initialize(t,o),history.pushState("","",rem.page_url+"?lat="+t+"&lng="+o),e.maxpages>1&&e.maxpages!==$(loadMoreButton).data("maxpages")&&($(loadMoreButton).data("maxpages",e.maxpages),$(loadMoreButton).show())):deleteMarkers(),$("#xlocate-estate-listing").html(e.listing).css("overflow-y","scroll"))},error:function(e,a,t){console.log(t)}})}$=jQuery;var map,markers=[],map_markers=[],xloc_default_latitude=27.7090319;void 0!==settings_data.default_latitude&&(xloc_default_latitude=parseFloat(settings_data.default_latitude));var xloc_default_longitude=85.2911132;void 0!==settings_data.default_longitude&&(xloc_default_longitude=parseFloat(settings_data.default_longitude));var xloc_default_zoom_level=15;void 0!==settings_data.default_zoom_level&&(xloc_default_zoom_level=parseInt(settings_data.default_zoom_level));var infoWindowContent=[],geocoder=new google.maps.Geocoder,infoWindow=new google.maps.InfoWindow,bounds,loadMoreButton="#xlocate-load-more",inputAddress="#search-address",markerCluster,searchForm=$("#search-form");jQuery(function(e){e(searchForm).on("submit",function(a){a.preventDefault(),searchProperties(e(this).serializeArray())});var a=e("#lat").val(),t=e("#lng").val();""!==a&&""!==t?(reverseGeoCode(a,t),e(searchForm).submit()):initialize_empty_map(),e(inputAddress).geocomplete({details:"#search-form"}).bind("geocode:result",function(a,t){e(searchForm).submit()}),e("#find-location, #xlocate-frontend-find-location").on("click",function(e){e.preventDefault(),realEstateGeoFindMe()}),e("#map-view").on("click",function(a){a.preventDefault(),e("#map_wrapper").show(),e("#xlocate-estate-listing").hide(),e(searchForm).submit()}),e("#list-view").on("click",function(a){a.preventDefault(),e("#xlocate-estate-listing").show(),e("#map_wrapper").hide(),e(searchForm).submit()}),e(inputAddress).on("click",function(){e(this).select()}),e(loadMoreButton).on("click",function(a){a.preventDefault();var t=e(searchForm).serialize(),o=e(this),r=e(this).data("paged")+1;r===e(o).data("maxpages")?e(this).hide():e(this).data("paged",r),searchProperties(t,r)})});